{
  "hash": "0dbf86c7edfa5b3e117c8c31b444fb52",
  "result": {
    "markdown": "---\ndate: 2014-07-23 07:57:28+00:00\nlink: https://robjhyndman.com/hyndsight/arma-roots/\nslug: arma-roots\ntitle: Plotting the characteristic roots for ARIMA models\ncategories:\n- computing\n- forecasting\n- R\n- statistics\n---\n\n\nWhen modelling data with ARIMA models, it is sometimes useful to plot the inverse characteristic roots. The following functions will compute and plot the inverse roots for any fitted ARIMA model (including seasonal models).<!-- more -->\n\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-1_92985c94676cc8e43ccf881726ddea9d'}\n\n```{.r .cell-code}\n# Compute AR roots\narroots <- function(object)\n{\n  if(!(\"Arima\" %in% class(object)) &\n     !(\"ar\" %in% class(object)))\n    stop(\"object must be of class Arima or ar\")\n  if(\"Arima\" %in% class(object))\n    parvec <- object$model$phi\n  else\n    parvec <- object$ar\n  if(length(parvec) > 0)\n  {\n    last.nonzero <- max(which(abs(parvec) > 1e-08))\n    if (last.nonzero > 0)\n      return(structure(list(\n          roots=polyroot(c(1,-parvec[1:last.nonzero])),\n          type=\"AR\"),\n        class='armaroots'))\n  }\n  return(structure(list(roots=numeric(0), type=\"AR\"),\n    class='armaroots'))\n}\n\n# Compute MA roots\nmaroots <- function(object)\n{\n  if(!(\"Arima\" %in% class(object)))\n    stop(\"object must be of class Arima\")\n  parvec <- object$model$theta\n  if(length(parvec) > 0)\n  {\n    last.nonzero <- max(which(abs(parvec) > 1e-08))\n    if (last.nonzero > 0)\n      return(structure(list(\n          roots=polyroot(c(1,parvec[1:last.nonzero])),\n          type=\"MA\"),\n        class='armaroots'))\n  }\n  return(structure(list(roots=numeric(0), type=\"MA\"),\n    class='armaroots'))\n}\n\nplot.armaroots <- function(x, xlab=\"Real\", ylab=\"Imaginary\",\n    main=paste(\"Inverse roots of\", x$type,\n          \"characteristic polynomial\"),\n    ...)\n{\n  oldpar <- par(pty='s')\n  on.exit(par(oldpar))\n  plot(c(-1,1), c(-1,1), xlab=xlab, ylab=ylab,\n       type=\"n\", bty=\"n\", xaxt=\"n\", yaxt=\"n\", main=main, ...)\n  axis(1, at=c(-1,0,1), line=0.5, tck=-0.025)\n  axis(2, at=c(-1,0,1), label=c(\"-i\",\"0\",\"i\"),\n    line=0.5, tck=-0.025)\n  circx <- seq(-1,1,l=501)\n  circy <- sqrt(1-circx^2)\n  lines(c(circx,circx), c(circy,-circy), col='gray')\n  lines(c(-2,2), c(0,0), col='gray')\n  lines(c(0,0), c(-2,2), col='gray')\n  if(length(x$roots) > 0)\n  {\n    inside <- abs(x$roots) > 1\n    points(1/x$roots[inside], pch=19, col='black')\n    if(sum(!inside) > 0)\n      points(1/x$roots[!inside], pch=19, col='red')\n  }\n}\n```\n:::\n\n\nThe `arroots` function will return the autoregressive roots from the AR characteristic polynomial while the `maroots` function will return the moving average roots from the MA characteristic polynomial. Both functions take an `Arima` object as their only argument. If a seasonal ARIMA model is passed, the roots from both polynomials are computed in each case.\n\nThe `plot.armaroots` function will plot the inverse of the roots on the complex unit circle. A causal invertible model should have all the roots outside the unit circle. Equivalently, the inverse roots should lie inside the unit circle.\n\nHere are a couple of examples demonstrating their use.\n\nA simple example with three AR roots:\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-2_ebb77bb5b6fa6860e0e71ec4461f7787'}\n\n```{.r .cell-code}\nlibrary(forecast)\nplot(arroots(Arima(WWWusage,c(3,1,0))))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\nA more complicated example with ten AR roots and four MA roots. (This is not actually the best model for these data.)\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-3_54bcd15dfe6075f64544b16fd945256b'}\n\n```{.r .cell-code}\nlibrary(forecast)\nfit <- Arima(woolyrnq,order=c(2,0,0),seasonal=c(2,1,1))\npar(mfrow=c(1,2))\nplot(arroots(fit),main=\"Inverse AR roots\")\nplot(maroots(fit),main=\"Inverse MA roots\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nFinally, here is an example where two inverse roots lie outside the unit circle (shown in red).\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-4_a87221da848d85f2fdf26e1b641532ca'}\n\n```{.r .cell-code}\nlibrary(fma)\nplot(arroots(ar.ols(jcars)))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nNote that the `Arima` function will never return a model with inverse roots outside the unit circle. The `auto.arima` function is even stricter and will not select a model with roots close to the unit circle either, as such models are unlikely to be good for forecasting.\n\n#### Update (23 March 2015)\n\nI've now added these functions to the [`forecast` package on github](https://github.com/robjhyndman/forecast). Check `plot.Arima`.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}