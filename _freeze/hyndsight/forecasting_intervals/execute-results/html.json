{
  "hash": "069d2af189c89bc32e50443302ffaa07",
  "result": {
    "markdown": "---\ntitle: Derivations of forecast variance for benchmark methods\n---\n\n\nIn my [forecasting textbook](https://otexts.com/fpp3/prediction-intervals.html#benchmark-methods) coauthored with George Athanasopoulos, we provide formulas for the forecast variances of four simple benchmark forecasting methods, but we don't explain where they come from. So here are the derivations.\n\nWe assume that the residuals from the method are uncorrelated and homoscedastic, with mean 0 and variance $\\sigma^2$. Let $y_1,\\dots,y_T$ denote the time series observations, and let $\\hat{y}_{T+h|T}$ be the estimated forecast mean (or point forecast). Then we can write\n$$y_t = \\hat{y}_{t|t-1} + \\varepsilon_t$$\nwhere $\\varepsilon$ is a white noise process.\n\nLet $\\hat\\sigma_h^2$ be the estimated $h$-step forecast variance.\n\n## Random walk/Naive method\n\nFor a random walk\n\\begin{align*}\ny_{T+1} &= y_T + \\varepsilon_T \\\\\ny_{T+2} &= y_{T+1} + \\varepsilon_{T+1}  = y_T + \\varepsilon_T + \\varepsilon_{T+1}\\\\\n\\vdots \\\\\ny_{T+h} &= y_T + \\sum_{i=1}^h \\varepsilon_{T+i}\n\\end{align*}\nTherefore\n\\begin{align*}\n\\hat{y}_{T+h|T} &= E(y_{T+h|T}) = y_T\\\\\n\\text{and}\\qquad\n\\hat{\\sigma}^2_{h} &= V(y_{T+h|T}) = h\\sigma^2\n\\end{align*}\n\n## Seasonal naive method\n\nLet $m$ denote the seasonal period\n\\begin{align*}\ny_{T+1} &= y_{T+1-m} + \\varepsilon_{T+1} \\\\\ny_{T+2} &= y_{T+2-m} + \\varepsilon_{T+2} \\\\\n\\vdots \\\\\ny_{T+m} &= y_{T} + \\varepsilon_{T+m} \\\\\ny_{T+m+1} &= y_{T+1} + \\varepsilon_{T+m+1} = y_{T+1-m} + \\varepsilon_{T+1} + \\varepsilon_{T+m+1}\\\\\n\\vdots\\\\\ny_{T+2m} &= y_{T+m} + \\varepsilon_{T+2m} = y_{T} + \\varepsilon_{T+m} + \\varepsilon_{T+2m}\\\\\ny_{T+2m+1} &= y_{T+m+1} + \\varepsilon_{T+2m+1} = y_{T+1-m} + \\varepsilon_{T+1} + \\varepsilon_{T+m+1} + \\varepsilon_{T+2m+1}\\\\\n\\vdots\\\\\ny_{T+h} &= y_{T+h-m(k+1)} + \\sum_{i=0}^{k} \\varepsilon_{T+h+m(i-k)},\n\\end{align*}\nwhere $k$ is the integer part of $(h-1) /m$ (i.e., the number of complete years in the forecast period prior to time $T+h$).\nTherefore\n\\begin{align*}\n\\hat{y}_{T+h|T} &= E(y_{T+h|T}) = y_{T+h-m(k+1)}\\\\\n\\text{and}\\qquad\n\\hat{\\sigma}^2_{h} &= V(y_{T+h|T}) = (k+1)\\sigma^2\n\\end{align*}\n\n## Mean method\n\nFor the mean method,\n\\begin{align*}\ny_{T+1} &= \\bar{y} + \\varepsilon_{T+1} \\\\\ny_{T+2} &= \\bar{y} + \\varepsilon_{T+1} \\\\\n\\dots\ny_{T+h} &= \\bar{y} + \\varepsilon_{T+h},\n\\end{align*}\nwhere $\\bar{y}_t = \\frac1T(y_1+\\cdots+y_T)$.\n\nwe assume that $y_t = \\mu + \\varepsilon_t$ where $\\varepsilon_t$ is a white noise process. Then $\\hat{y}_{T+h|T} = \\hat\\mu = \\frac1T(y_1+\\cdots+y_T)$.\n\n\n\n\nand $\\hat\\sigma_h^2$ be the estimated $h$-step forecast variance. The latter are shown in the following table, where $m$ is the seasonal period,\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Benchmark method </th>\n   <th style=\"text-align:left;\"> $h$-step forecast standard deviation </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Mean </td>\n   <td style=\"text-align:left;\"> $\\hat\\sigma_h = \\hat\\sigma\\sqrt{1 + 1/T}$ </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Naïve </td>\n   <td style=\"text-align:left;\"> $\\hat\\sigma_h = \\hat\\sigma\\sqrt{h}$ </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Seasonal naïve </td>\n   <td style=\"text-align:left;\"> $\\hat\\sigma_h = \\hat\\sigma\\sqrt{k+1}$ </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Drift </td>\n   <td style=\"text-align:left;\"> $\\hat\\sigma_h = \\hat\\sigma\\sqrt{h(1+h/(T-1))}$ </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}